'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
var Validate = function () {
  function Validate() {
    //this.error = null;
    //this.validationData = null;
    //this.validate = null;
  }

  Validate.EXISTS_VALIDATE = 0; //或者0 存在字段就验证（默认）
  Validate.MUST_VALIDATE = 1; //或者1 必须验证
  Validate.VALUE_VALIDATE = 2; //或者2 值不为空的时候验证验证时间：
  Validate.MODEL_INSERT = 1; //或者1新增数据时候验证
  Validate.MODEL_UPDATE = 2; //或者2编辑数据时候验证
  Validate.MODEL_BOTH = 3; //或者3全部情况下验证（默认）

  Validate.check = function (data, validates) {
    this.error = null;
    this.validationData = {};
    if (!validates) {
      validates = this.validate;
    }

    //去除data值中的空格
    for (var k in data) {
      if (typeof data[k] === "string") {
        data[k] = data[k].trim();
      }
    }
    for (var key in validates) {
      var validate = validates[key];
      validate[3] = validate[3] ? validate[3] : this.EXISTS_VALIDATE;
      validate[4] = validate[4] ? validate[4] : 'regex';
      switch (validate[3]) {
        case this.MUST_VALIDATE:
          {
            //必须验证
            this._validationField(data, validate);
            break;
          }
        case this.VALUE_VALIDATE:
          {
            //不为空验证
            if (!/^\s*$/ig.test(data[validate[0]])) {
              this._validationField(data, validate);
            }
            break;
          }
        case this.EXISTS_VALIDATE:
        default:
          {
            //存在验证
            if (validate[0] in data) {
              this._validationField(data, validate);
            }
            break;
          }
      }
    }
    return Object.assign(data, this.validationData);
  };
  Validate._validationField = function (data, validate) {

    if (!this._validationFieldItem(data, validate)) {
      throw new Error(validate[2]);
    } else {
      if (!this.validationData) {
        this.validationData = {};
      }
      this.validationData[validate[0]] = data[validate[0]];
    }
  };
  Validate._validationFieldItem = function (data, validate) {
    validate[4] = validate[4].toLowerCase();
    switch (validate[4]) {
      case 'confirm':
        {
          return data[validate[0]] === data[validate[1]];
        }
      default:
        {
          return this._check(data[validate[0]], validate[1], validate[4]);
        }
    }
  };
  Validate._check = function (value, rule, type) {
    if (type === void 0) {
      type = 'regex';
    }
    type = type.toLowerCase();
    switch (type) {
      case 'between':
      case 'notbetween':
        {
          if (rule.length != 2) {
            throw TypeError("验证规则类型错误");
          }
          value = parseInt(value);
          var min = rule[0];
          var max = rule[1];
          return type == 'between' ? min <= value && value <= max : min > value || value > max;
        }
      case 'notin':
      case 'in':
        {
          return type == 'notin' ? rule.indexOf(value + '') == -1 : rule.indexOf(value + '') > -1;
        }
      case 'equal':
      case 'notequal':
        {
          return type == 'equal' ? value === rule : value !== rule;
        }
      case 'length':
        {
          var min = rule[0];
          var max = rule[1];
          var length_1 = value.length;
          return min <= length_1 && length_1 <= max;
        }
      case 'regex':
      default:
        {
          return this.regex(rule, value);
        }
    }
  };
  Validate.regex = function (reg, value) {
    var validate = {
      'require': /\S+/,
      'email': /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,
      'tel': /^((13[0-9])|(15[^4,\D])|(18[0,0-9]))\d{8}$/g,
      'api': /^(((\/[A-Za-z0-9-+.]+)|(\/:[^0-9]\w*)))+$/g,
      'number': /^\d+$/g
    };
    if (reg in validate) {
      reg = validate[reg];
    }
    try {
      return reg.test(typeof value !== 'undefined' ? value : '');
    } catch (e) {
      console.log(e);
      return false;
    }
  };
  return Validate;
}();
exports.default = Validate;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlZhbGlkYXRlLmpzIl0sIm5hbWVzIjpbIlZhbGlkYXRlIiwiRVhJU1RTX1ZBTElEQVRFIiwiTVVTVF9WQUxJREFURSIsIlZBTFVFX1ZBTElEQVRFIiwiTU9ERUxfSU5TRVJUIiwiTU9ERUxfVVBEQVRFIiwiTU9ERUxfQk9USCIsImNoZWNrIiwiZGF0YSIsInZhbGlkYXRlcyIsImVycm9yIiwidmFsaWRhdGlvbkRhdGEiLCJ2YWxpZGF0ZSIsImsiLCJ0cmltIiwia2V5IiwiX3ZhbGlkYXRpb25GaWVsZCIsInRlc3QiLCJPYmplY3QiLCJhc3NpZ24iLCJfdmFsaWRhdGlvbkZpZWxkSXRlbSIsIkVycm9yIiwidG9Mb3dlckNhc2UiLCJfY2hlY2siLCJ2YWx1ZSIsInJ1bGUiLCJ0eXBlIiwibGVuZ3RoIiwiVHlwZUVycm9yIiwicGFyc2VJbnQiLCJtaW4iLCJtYXgiLCJpbmRleE9mIiwibGVuZ3RoXzEiLCJyZWdleCIsInJlZyIsImUiLCJjb25zb2xlIiwibG9nIl0sIm1hcHBpbmdzIjoiOzs7OztBQUFBLElBQUlBLFdBQVksWUFBWTtBQUMxQixXQUFTQSxRQUFULEdBQW9CO0FBQ2xCO0FBQ0E7QUFDQTtBQUNEOztBQUVEQSxXQUFTQyxlQUFULEdBQTJCLENBQTNCLENBUDBCLENBT0k7QUFDOUJELFdBQVNFLGFBQVQsR0FBeUIsQ0FBekIsQ0FSMEIsQ0FRRTtBQUM1QkYsV0FBU0csY0FBVCxHQUEwQixDQUExQixDQVQwQixDQVNHO0FBQzdCSCxXQUFTSSxZQUFULEdBQXdCLENBQXhCLENBVjBCLENBVUM7QUFDM0JKLFdBQVNLLFlBQVQsR0FBd0IsQ0FBeEIsQ0FYMEIsQ0FXQztBQUMzQkwsV0FBU00sVUFBVCxHQUFzQixDQUF0QixDQVowQixDQVlEOztBQUV6Qk4sV0FBU08sS0FBVCxHQUFpQixVQUFVQyxJQUFWLEVBQWdCQyxTQUFoQixFQUEyQjtBQUMxQyxTQUFLQyxLQUFMLEdBQWEsSUFBYjtBQUNBLFNBQUtDLGNBQUwsR0FBc0IsRUFBdEI7QUFDQSxRQUFJ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QUdiLGFBQU8sNkNBSE07QUFJYixhQUFPLDRDQUpNO0FBS2IsZ0JBQVU7QUFMRyxLQUFmO0FBT0EsUUFBSXVCLE9BQU92QixRQUFYLEVBQXFCO0FBQ25CdUIsWUFBTXZCLFNBQVN1QixHQUFULENBQU47QUFDRDtBQUNELFFBQUk7QUFDRixhQUFPQSxJQUFJbEIsSUFBSixDQUFTLE9BQU9PLEtBQVAsS0FBaUIsV0FBakIsR0FBK0JBLEtBQS9CLEdBQXVDLEVBQWhELENBQVA7QUFDRCxLQUZELENBR0EsT0FBT1ksQ0FBUCxFQUFVO0FBQ1JDLGNBQVFDLEdBQVIsQ0FBWUYsQ0FBWjtBQUNBLGFBQU8sS0FBUDtBQUNEO0FBQ0YsR0FsQkQ7QUFtQkEsU0FBT3BDLFFBQVA7QUFDRCxDQXZJZSxFQUFoQjtrQkF3SWVBLFEiLCJmaWxlIjoiVmFsaWRhdGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgVmFsaWRhdGUgPSAoZnVuY3Rpb24gKCkge1xyXG4gIGZ1bmN0aW9uIFZhbGlkYXRlKCkge1xyXG4gICAgLy90aGlzLmVycm9yID0gbnVsbDtcclxuICAgIC8vdGhpcy52YWxpZGF0aW9uRGF0YSA9IG51bGw7XHJcbiAgICAvL3RoaXMudmFsaWRhdGUgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgVmFsaWRhdGUuRVhJU1RTX1ZBTElEQVRFID0gMDsgLy/miJbogIUwIOWtmOWcqOWtl+auteWwsemqjOivge+8iOm7mOiupO+8iVxyXG4gIFZhbGlkYXRlLk1VU1RfVkFMSURBVEUgPSAxOyAvL+aIluiAhTEg5b+F6aG76aqM6K+BXHJcbiAgVmFsaWRhdGUuVkFMVUVfVkFMSURBVEUgPSAyOyAvL+aIluiAhTIg5YC85LiN5Li656m655qE5pe25YCZ6aqM6K+B6aqM6K+B5pe26Ze077yaXHJcbiAgVmFsaWRhdGUuTU9ERUxfSU5TRVJUID0gMTsgLy/miJbogIUx5paw5aKe5pWw5o2u5pe25YCZ6aqM6K+BXHJcbiAgVmFsaWRhdGUuTU9ERUxfVVBEQVRFID0gMjsgLy/miJbogIUy57yW6L6R5pWw5o2u5pe25YCZ6aqM6K+BXHJcbiAgVmFsaWRhdGUuTU9ERUxfQk9USCA9IDM7IC8v5oiW6ICFM+WFqOmDqOaDheWGteS4i+mqjOivge+8iOm7mOiupO+8iVxyXG5cclxuICBWYWxpZGF0ZS5jaGVjayA9IGZ1bmN0aW9uIChkYXRhLCB2YWxpZGF0ZXMpIHtcclxuICAgIHRoaXMuZXJyb3IgPSBudWxsO1xyXG4gICAgdGhpcy52YWxpZGF0aW9uRGF0YSA9IHt9O1xyXG4gICAgaWYgKCF2YWxpZGF0ZXMpIHtcclxuICAgICAgdmFsaWRhdGVzID0gdGhpcy52YWxpZGF0ZTtcclxuICAgIH1cclxuXHJcbiAgICAvL+WOu+mZpGRhdGHlgLzkuK3nmoTnqbrmoLxcclxuICAgIGZvciAobGV0IGsgaW4gZGF0YSkge1xyXG4gICAgICBpZiAodHlwZW9mIGRhdGFba10gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICBkYXRhW2tdID0gZGF0YVtrXS50cmltKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGZvciAodmFyIGtleSBpbiB2YWxpZGF0ZXMpIHtcclxuICAgICAgdmFyIHZhbGlkYXRlID0gdmFsaWRhdGVzW2tleV07XHJcbiAgICAgIHZhbGlkYXRlWzNdID0gdmFsaWRhdGVbM10gPyB2YWxpZGF0ZVszXSA6IHRoaXMuRVhJU1RTX1ZBTElEQVRFO1xyXG4gICAgICB2YWxpZGF0ZVs0XSA9IHZhbGlkYXRlWzRdID8gdmFsaWRhdGVbNF0gOiAncmVnZXgnO1xyXG4gICAgICBzd2l0Y2ggKHZhbGlkYXRlWzNdKSB7XHJcbiAgICAgICAgY2FzZSB0aGlzLk1VU1RfVkFMSURBVEU6IHtcclxuICAgICAgICAgIC8v5b+F6aG76aqM6K+BXHJcbiAgICAgICAgICB0aGlzLl92YWxpZGF0aW9uRmllbGQoZGF0YSwgdmFsaWRhdGUpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhc2UgdGhpcy5WQUxVRV9WQUxJREFURToge1xyXG4gICAgICAgICAgLy/kuI3kuLrnqbrpqozor4FcclxuICAgICAgICAgIGlmICghKC9eXFxzKiQvaWcudGVzdChkYXRhW3ZhbGlkYXRlWzBdXSkpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3ZhbGlkYXRpb25GaWVsZChkYXRhLCB2YWxpZGF0ZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FzZSB0aGlzLkVYSVNUU19WQUxJREFURTpcclxuICAgICAgICBkZWZhdWx0OiB7XHJcbiAgICAgICAgICAvL+WtmOWcqOmqjOivgVxyXG4gICAgICAgICAgaWYgKHZhbGlkYXRlWzBdIGluIGRhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5fdmFsaWRhdGlvbkZpZWxkKGRhdGEsIHZhbGlkYXRlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oZGF0YSwgdGhpcy52YWxpZGF0aW9uRGF0YSk7XHJcbiAgfTtcclxuICBWYWxpZGF0ZS5fdmFsaWRhdGlvbkZpZWxkID0gZnVuY3Rpb24gKGRhdGEsIHZhbGlkYXRlKSB7XHJcblxyXG4gICAgaWYgKCF0aGlzLl92YWxpZGF0aW9uRmllbGRJdGVtKGRhdGEsIHZhbGlkYXRlKSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IodmFsaWRhdGVbMl0pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIGlmICghdGhpcy52YWxpZGF0aW9uRGF0YSkge1xyXG4gICAgICAgIHRoaXMudmFsaWRhdGlvbkRhdGEgPSB7fTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnZhbGlkYXRpb25EYXRhW3ZhbGlkYXRlWzBdXSA9IGRhdGFbdmFsaWRhdGVbMF1dO1xyXG4gICAgfVxyXG4gIH07XHJcbiAgVmFsaWRhdGUuX3ZhbGlkYXRpb25GaWVsZEl0ZW0gPSBmdW5jdGlvbiAoZGF0YSwgdmFsaWRhdGUpIHtcclxuICAgIHZhbGlkYXRlWzRdID0gdmFsaWRhdGVbNF0udG9Mb3dlckNhc2UoKTtcclxuICAgIHN3aXRjaCAodmFsaWRhdGVbNF0pIHtcclxuICAgICAgY2FzZSAnY29uZmlybSc6IHtcclxuICAgICAgICByZXR1cm4gZGF0YVt2YWxpZGF0ZVswXV0gPT09IGRhdGFbdmFsaWRhdGVbMV1dO1xyXG4gICAgICB9XHJcbiAgICAgIGRlZmF1bHQ6IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2hlY2soZGF0YVt2YWxpZGF0ZVswXV0sIHZhbGlkYXRlWzFdLCB2YWxpZGF0ZVs0XSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG4gIFZhbGlkYXRlLl9jaGVjayA9IGZ1bmN0aW9uICh2YWx1ZSwgcnVsZSwgdHlwZSkge1xyXG4gICAgaWYgKHR5cGUgPT09IHZvaWQgMCkge1xyXG4gICAgICB0eXBlID0gJ3JlZ2V4JztcclxuICAgIH1cclxuICAgIHR5cGUgPSB0eXBlLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgY2FzZSAnYmV0d2Vlbic6XHJcbiAgICAgIGNhc2UgJ25vdGJldHdlZW4nOiB7XHJcbiAgICAgICAgaWYgKHJ1bGUubGVuZ3RoICE9IDIpIHtcclxuICAgICAgICAgIHRocm93IFR5cGVFcnJvcihcIumqjOivgeinhOWImeexu+Wei+mUmeivr1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsdWUgPSBwYXJzZUludCh2YWx1ZSk7XHJcbiAgICAgICAgdmFyIG1pbiA9IHJ1bGVbMF07XHJcbiAgICAgICAgdmFyIG1heCA9IHJ1bGVbMV07XHJcbiAgICAgICAgcmV0dXJuIHR5cGUgPT0gJ2JldHdlZW4nID8gbWluIDw9IHZhbHVlICYmIHZhbHVlIDw9IG1heCA6IG1pbiA+IHZhbHVlIHx8IHZhbHVlID4gbWF4O1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ25vdGluJzpcclxuICAgICAgY2FzZSAnaW4nOiB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGUgPT0gJ25vdGluJyA/IHJ1bGUuaW5kZXhPZih2YWx1ZSArICcnKSA9PSAtMSA6IHJ1bGUuaW5kZXhPZih2YWx1ZSArICcnKSA+IC0xO1xyXG4gICAgICB9XHJcbiAgICAgIGNhc2UgJ2VxdWFsJzpcclxuICAgICAgY2FzZSAnbm90ZXF1YWwnOiB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGUgPT0gJ2VxdWFsJyA/IHZhbHVlID09PSBydWxlIDogdmFsdWUgIT09IHJ1bGU7XHJcbiAgICAgIH1cclxuICAgICAgY2FzZSAnbGVuZ3RoJzoge1xyXG4gICAgICAgIHZhciBtaW4gPSBydWxlWzBdO1xyXG4gICAgICAgIHZhciBtYXggPSBydWxlWzFdO1xyXG4gICAgICAgIHZhciBsZW5ndGhfMSA9IHZhbHVlLmxlbmd0aDtcclxuICAgICAgICByZXR1cm4gbWluIDw9IGxlbmd0aF8xICYmIGxlbmd0aF8xIDw9IG1heDtcclxuICAgICAgfVxyXG4gICAgICBjYXNlICdyZWdleCc6XHJcbiAgICAgIGRlZmF1bHQ6IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZWdleChydWxlLCB2YWx1ZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG4gIFZhbGlkYXRlLnJlZ2V4ID0gZnVuY3Rpb24gKHJlZywgdmFsdWUpIHtcclxuICAgIHZhciB2YWxpZGF0ZSA9IHtcclxuICAgICAgJ3JlcXVpcmUnOiAvXFxTKy8sXHJcbiAgICAgICdlbWFpbCc6IC9eXFx3KyhbLSsuXVxcdyspKkBcXHcrKFstLl1cXHcrKSpcXC5cXHcrKFstLl1cXHcrKSokLyxcclxuICAgICAgJ3RlbCc6IC9eKCgxM1swLTldKXwoMTVbXjQsXFxEXSl8KDE4WzAsMC05XSkpXFxkezh9JC9nLFxyXG4gICAgICAnYXBpJzogL14oKChcXC9bQS1aYS16MC05LSsuXSspfChcXC86W14wLTldXFx3KikpKSskL2csXHJcbiAgICAgICdudW1iZXInOiAvXlxcZCskL2dcclxuICAgIH07XHJcbiAgICBpZiAocmVnIGluIHZhbGlkYXRlKSB7XHJcbiAgICAgIHJlZyA9IHZhbGlkYXRlW3JlZ107XHJcbiAgICB9XHJcbiAgICB0cnkge1xyXG4gICAgICByZXR1cm4gcmVnLnRlc3QodHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJyA/IHZhbHVlIDogJycpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5sb2coZSlcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH07XHJcbiAgcmV0dXJuIFZhbGlkYXRlO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBWYWxpZGF0ZTsiXX0=