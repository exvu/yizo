##创建跑跑订单
#addOrderRun
insert into order_runs set ?;

##获取订单创建人和跑跑 不用 
#getUserToOrder   
SELECT
  run_orders.run_order_id,
  creater,
  GROUP_CONCAT(user_id) as users
FROM run_orders
  JOIN run_order_details ON run_orders.run_order_id = run_order_details.run_order_id
  where run_orders.run_order_id = ?
GROUP BY run_orders.run_order_id;

##获取订单的创建人和跑跑信息
#gerInfoToOrderRun
SELECT
  creater,
  runner,
  status
FROM orders
  JOIN order_runs ON order_runs.`order_id` = orders.`order_id`
WHERE orders.order_id = ?;
##修改信息
#updateOrderRun
UPDATE order_runs
SET ?
WHERE order_id = ?


##添加多用户的跑跑订单
#addMultiRunOrder
insert into order_multi_runs set ?

##獲取多用戶訂單的創建人和用户
#getMultiCreateAndUser
SELECT
  creater,
  GROUP_CONCAT(USER) AS users,
  orders.`status`
FROM orders
  JOIN order_multi_runs ON order_multi_runs.`order_id` = orders.`order_id`
  JOIN order_multi_run_details ON order_multi_runs.`order_id` = order_multi_run_details.`order_id`
WHERE orders.`order_id`= ? ;

##添加多用户订单用户详情单
#addMultiOrderDetail
INSERT INTO order_multi_run_details SET ?;

##更新detail
#updateMutilOrderDetail
update order_multi_run_details set ? where user=? and order_id=?;


##当所有的订单都结束  关闭订单
#setOrderEnd
UPDATE orders
SET orders.`status` = 4
WHERE NOT EXISTS(
    SELECT `status`
    FROM order_multi_run_details
    WHERE order_multi_run_details.`status` <> 4 AND order_multi_run_details.`order_id` = ?
) AND `order_id` = ?;
